<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能分析应用平台</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/form.css">
    <link rel="stylesheet" href="css/report.css">
    <link rel="stylesheet" href="css/pdf-styles.css">
    <link rel="stylesheet" href="css/market-analysis.css?v=20250628-14">
</head>
<body>
    <div class="app-container">
        <!-- 应用头部 -->
        <header class="app-header">
            <h1>智能分析应用平台</h1>
            <p class="subtitle">基于AI智能分析，提供品牌定位分析和商圈调研分析服务</p>
        </header>

        <!-- 主要内容区域 - 双模块布局 -->
        <main class="main-content dual-module-layout">
            <!-- 左侧：品牌定位分析模块 -->
            <div class="module-container brand-analysis-module">
                <div class="module-header">
                    <h2 class="module-title">品牌定位分析</h2>
                    <p class="module-subtitle">快速生成专业的品牌定位报告</p>
                </div>
                <!-- 品牌定位分析 - 输入表单区域 -->
                <section id="brand-input-section" class="section active">
                    <div class="container">
                        <h3 class="section-title">店铺信息输入</h3>
                    
                        <form id="brand-store-form" class="store-form">
                        <!-- 基础信息 -->
                        <div class="form-section">
                            <h3 class="form-section-title">基础信息</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="storeName">店铺名称 <span class="required">*</span></label>
                                    <input type="text" id="storeName" name="storeName" required 
                                           placeholder="请输入店铺名称" maxlength="50">
                                    <div class="error-message" id="storeName-error"></div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="category">经营品类 <span class="required">*</span></label>
                                    <input type="text" id="category" name="category" required
                                           placeholder="请输入经营品类，如：川菜、奶茶、烧烤、轻食等" maxlength="100">
                                    <div class="form-hint">
                                        <small>常见品类：川菜、湘菜、粤菜、烧烤、麻辣烫、奶茶、咖啡、轻食、盖饭、炒饭等</small>
                                    </div>
                                    <div class="error-message" id="category-error"></div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="address">店铺地址</label>
                                <input type="text" id="address" name="address" 
                                       placeholder="请输入店铺地址" maxlength="200">
                            </div>
                        </div>

                        <!-- 详细信息 -->
                        <div class="form-section">
                            <h3 class="form-section-title">详细信息</h3>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="targetGroup">目标客群</label>
                                    <div class="checkbox-group">
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="targetGroup" value="白领上班族">
                                            <span>白领上班族</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="targetGroup" value="学生群体">
                                            <span>学生群体</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="targetGroup" value="健身爱好者">
                                            <span>健身爱好者</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="targetGroup" value="年轻消费者">
                                            <span>年轻消费者</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="targetGroup" value="家庭用户">
                                            <span>家庭用户</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="targetGroup" value="夜宵用户">
                                            <span>夜宵用户</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="priceRange">价格区间</label>
                                    <div class="price-range">
                                        <input type="range" id="priceRange" name="priceRange" 
                                               min="10" max="100" value="25" step="5">
                                        <div class="price-display">
                                            人均消费：<span id="priceValue">25</span>元
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="mainProducts">主营产品</label>
                                    <input type="text" id="mainProducts" name="mainProducts" 
                                           placeholder="请输入主营产品，如：日式盖饭、炒饭、轻食沙拉" maxlength="200">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="features">经营特色</label>
                                <textarea id="features" name="features" rows="3" 
                                          placeholder="请描述店铺的经营特色和优势，如：健康低脂、新鲜食材、快速出餐等" maxlength="500"></textarea>
                            </div>
                        </div>

                        <!-- 提交按钮 -->
                        <div class="form-actions">
                            <button type="submit" id="brand-generateBtn" class="btn btn-primary">
                                <span class="btn-text">生成品牌分析报告</span>
                                <span class="btn-loading" style="display: none;">
                                    <span class="loading-spinner"></span>
                                    正在生成中...
                                </span>
                            </button>
                        </div>
                    </form>
                </div>
                </section>

                <!-- 品牌定位分析 - 报告展示区域 -->
                <section id="brand-report-section" class="section" style="display: none;">
                    <div class="container">
                        <div class="report-header">
                            <h3 class="section-title">品牌定位分析报告</h3>
                            <div class="report-actions">
                                <button id="brand-editBtn" class="btn btn-secondary">重新编辑</button>
                                <button id="brand-downloadBtn" class="btn btn-primary">下载PDF</button>
                            </div>
                        </div>

                        <!-- 报告内容将在这里动态生成 -->
                        <div id="brand-report-content" class="report-content">
                            <!-- 报告内容将通过JavaScript动态插入 -->
                        </div>
                    </div>
                </section>

                <!-- 品牌定位分析 - 加载状态 -->
                <div id="brand-loading-overlay" class="loading-overlay" style="display: none;">
                    <div class="loading-content">
                        <div class="loading-spinner-large"></div>
                        <p class="loading-text">正在调用AI生成品牌分析报告...</p>
                        <p class="loading-subtext">请稍候，这可能需要10-30秒</p>
                    </div>
                </div>
            </div>

            <!-- 右侧：商圈调研分析模块 -->
            <div class="module-container market-analysis-module">
                <div class="module-header">
                    <h2 class="module-title">商圈调研分析</h2>
                    <p class="module-subtitle">基于竞争对手分析的商圈调研报告</p>
                </div>

                <!-- 商圈调研分析 - 输入表单区域 -->
                <section id="market-input-section" class="market-section active">
                    <div class="market-container">
                        <h3 class="market-section-title">商圈调研信息输入</h3>

                        <form id="market-survey-form" class="market-form">
                            <!-- 基础信息 -->
                            <div class="market-form-section">
                                <h4 class="market-form-section-title">基础信息</h4>

                                <div class="market-form-row">
                                    <div class="market-form-group">
                                        <label for="market-areaName">店铺名称 <span class="required">*</span></label>
                                        <input type="text" id="market-areaName" name="areaName" required
                                               placeholder="请输入店铺名称" maxlength="50">
                                        <div class="error-message" id="market-areaName-error"></div>
                                    </div>

                                    <div class="market-form-group">
                                        <label for="market-location">经营品类 <span class="required">*</span></label>
                                        <input type="text" id="market-location" name="location" required
                                               placeholder="请输入经营品类，如：中式快餐、奶茶饮品、烘焙甜品等" maxlength="100">
                                        <div class="error-message" id="market-location-error"></div>
                                    </div>
                                </div>

                                <div class="market-form-group">
                                    <label for="market-areaType">店铺地址 <span class="required">*</span></label>
                                    <input type="text" id="market-areaType" name="areaType" required
                                           placeholder="请输入店铺具体地址，如：北京市朝阳区三里屯太古里" maxlength="100">
                                    <div class="error-message" id="market-areaType-error"></div>
                                </div>
                            </div>

                            <!-- 竞争对手文档分析 -->
                            <div class="market-form-section">
                                <h4 class="market-form-section-title">竞争对手文档分析（可选）</h4>
                                <p class="market-form-description">
                                    上传包含竞争对手信息的文本文档（目前仅支持TXT格式），AI将自动分析竞争对手的产品、定价策略，并为您提供针对性的优化建议。
                                    <br><small style="color: #666;">注意：DeepSeek API目前不支持图片、PDF等格式的直接分析，请将内容转换为文本格式后上传。</small>
                                </p>

                                <div class="market-form-group">
                                    <label for="market-storeName">您的店铺名称</label>
                                    <input type="text" id="market-storeName" name="storeName"
                                           placeholder="请输入您的店铺名称，用于区分竞争对手" maxlength="50">
                                    <div class="error-message" id="market-storeName-error"></div>
                                </div>

                                <div class="market-form-group">
                                    <label for="market-document">竞争对手文档</label>
                                    <div class="market-file-upload-area" id="market-file-upload-area">
                                        <input type="file" id="market-document" name="document"
                                               accept=".txt"
                                               style="display: none;">
                                        <div class="market-file-upload-content">
                                            <i class="fas fa-cloud-upload-alt market-upload-icon"></i>
                                            <p class="market-upload-text">点击上传或拖拽TXT文档到此处</p>
                                            <p class="market-upload-hint">仅支持TXT文本格式，最大10MB</p>
                                        </div>
                                        <div class="market-file-preview" id="market-file-preview" style="display: none;">
                                            <div class="market-file-info">
                                                <i class="fas fa-file market-file-icon"></i>
                                                <span class="market-file-name"></span>
                                                <span class="market-file-size"></span>
                                                <button type="button" class="market-file-remove" title="移除文件">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="error-message" id="market-document-error"></div>
                                </div>

                                <div class="market-form-group">
                                    <label class="market-checkbox-item">
                                        <input type="checkbox" id="market-enableDocumentAnalysis" name="enableDocumentAnalysis">
                                        <span>启用文档分析功能（将使用AI分析上传的竞争对手文档）</span>
                                    </label>
                                </div>
                            </div>

                            <!-- 提交按钮 -->
                            <div class="market-form-actions">
                                <button type="submit" id="market-generateBtn" class="market-btn market-btn-primary">
                                    <span class="market-btn-text">生成商圈分析报告</span>
                                    <span class="market-btn-loading" style="display: none;">
                                        <span class="market-loading-spinner"></span>
                                        正在生成中...
                                    </span>
                                </button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- 商圈调研分析 - 报告展示区域 -->
                <section id="market-report-section" class="market-section" style="display: none;">
                    <div class="market-container">
                        <div class="market-report-header">
                            <h3 class="market-section-title">商圈调研分析报告</h3>
                            <div class="market-report-actions">
                                <button id="market-editBtn" class="market-btn market-btn-secondary">重新编辑</button>
                                <button id="market-downloadBtn" class="market-btn market-btn-primary">下载PDF</button>
                            </div>
                        </div>

                        <!-- 报告内容将在这里动态生成 -->
                        <div id="market-report-content" class="market-report-content">
                            <!-- 报告内容将通过JavaScript动态插入 -->
                        </div>
                    </div>
                </section>

                <!-- 商圈调研分析 - 加载状态 -->
                <div id="market-loading-overlay" class="market-loading-overlay" style="display: none;">
                    <div class="market-loading-content">
                        <div class="market-loading-spinner-large"></div>
                        <p class="market-loading-text">正在调用AI生成商圈分析报告...</p>
                        <p class="market-loading-subtext">请稍候，这可能需要10-30秒</p>
                    </div>
                </div>
            </div>
        </main>

        <!-- 页脚 -->
        <footer class="app-footer">
            <p>&copy; 2024 品牌定位分析应用 - 基于DeepSeek AI技术</p>
        </footer>
    </div>

    <!-- 第三方库 -->
    <!-- html-to-image: 优化的PDF导出方案 -->
    <script src="https://cdn.jsdelivr.net/npm/html-to-image@1.11.13/dist/html-to-image.js"></script>
    <!-- 保留html2canvas作为备用方案 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <!-- JavaScript文件 - 品牌定位分析模块 -->
    <script src="templates/prompt-template.js?v=20250628-10"></script>
    <script src="js/api-client.js?v=20250628-10"></script>
    <script src="js/form-handler.js?v=20250628-10"></script>
    <script src="js/content-generator.js?v=20250628-10"></script>
    <script src="js/report-renderer.js?v=20250628-10"></script>
    <!-- 新的html-to-image PDF导出器 - 可变高度PDF -->
    <script src="js/html-to-image-pdf-exporter.js?v=20250628-13"></script>
    <!-- 保留原有PDF导出器作为备用 -->
    <script src="js/pdf-exporter.js?v=20250628-10"></script>
    <script src="js/app.js?v=20250628-10"></script>

    <!-- JavaScript文件 - 商圈调研分析模块 -->
    <script src="templates/market-prompt-template.js?v=20250628-14"></script>
    <script src="js/market-api-client.js?v=20250628-10"></script>
    <script src="js/market-form-handler.js?v=20250628-14"></script>
    <script src="js/market-content-generator.js?v=20250628-14"></script>
    <script src="js/market-report-renderer.js?v=20250628-10"></script>
    <script src="js/market-pdf-exporter.js?v=20250628-10"></script>
    <script src="js/market-app.js?v=20250628-14"></script>
</body>
</html>
